<!DOCTYPE html>
<html>

<head>
    <!-- ... ของอื่นๆ ... -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/treegrid/1.0.9/css/jquery.treegrid.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/treegrid/1.0.9/js/jquery.treegrid.min.js"></script>
</head>

<body>
    <table id="menuCategoriesTable" class="table table-bordered table-hover treegrid" style="width:100%">
        <thead>
            <tr>
                <th data-treegrid="true">Category ID</th>
                <th>Category Text</th>
                <!-- ข้อมูลอื่นๆ ของตาราง -->
            </tr>
        </thead>
        <tbody>
            <!-- ใส่ข้อมูลของตารางที่นี่ -->
        </tbody>
    </table>

    <script>
        $(document).ready(function() {
            // ตัวแปรเก็บสถานะการแสดงของแต่ละลำดับชั้น
            var isCollapsed = {};

            // กำหนดข้อมูลสำหรับตาราง DataTables
            var menuCategoriesData = [{
                id: 1,
                text: "Category 1",
                parent: null
            }, {
                id: 2,
                text: "Category 2",
                parent: null
            }, {
                id: 3,
                text: "Subcategory 1-1",
                parent: 1
            }, {
                id: 4,
                text: "Subcategory 1-2",
                parent: 1
            }, {
                id: 5,
                text: "Subcategory 2-1",
                parent: 2
            }, {
                id: 6,
                text: "Subcategory 2-2",
                parent: 2
            }, {
                id: 7,
                text: "Subsubcategory 1-1-1",
                parent: 3
            }, {
                id: 8,
                text: "Subsubcategory 1-1-2",
                parent: 3
            }, ];

            // สร้างตาราง DataTables TreeGrid
            var menuCategoriesTable = $("#menuCategoriesTable").DataTable({
                data: menuCategoriesData,
                columns: [{
                        data: "id"
                    }, {
                        data: "text"
                    },
                    // คอลัมน์อื่นๆ ของตาราง
                ],
                order: [
                    [0, "asc"]
                ],
                columnDefs: [{
                        // targets: 0,
                        // visible: false,
                        // searchable: false
                    }, // ซ่อนคอลัมน์ ID
                    {
                        targets: 1,
                        className: "treegrid-control"
                    }, // กำหนดคลาส treegrid-control ให้คอลัมน์ Category Text
                ]
            });

            // เรียกใช้งาน plugin treegrid หลังจากที่ DataTables ถูกสร้างเสร็จ
            $("#menuCategoriesTable").treegrid({
                expanderExpandedClass: "fas fa-minus",
                expanderCollapsedClass: "fas fa-plus",
                initialState: function($row, id) {
                    // ตรวจสอบสถานะการซ่อนและแสดงของแต่ละลำดับชั้น
                    if (isCollapsed[id]) {
                        return "collapsed";
                    }
                },
                onChange: function(id) {
                    // อัปเดตสถานะการซ่อนและแสดงของแต่ละลำดับชั้นเมื่อมีการเปิดหรือปิด
                    isCollapsed[id] = !isCollapsed[id];
                },
            });
        });
    </script>
</body>

</html>